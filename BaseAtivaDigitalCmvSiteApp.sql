/*Segue abaixo o exemplo de trazer quais canais de atendimentos estão cadastrados após a tag “origem”*/;;-- EXEMPLO PARA EXTRAIR E VERIFICAR OS CAMPOS DO                  ;SELECT /*+parallel (12)*/ DISTINCT TRIM(SUBSTR(NM_DESC_PEDIDO,INSTR(NM_DESC_PEDIDO,'|origem:')+8)) AS TESTE;FROM INN.EXT_ADMINSITE ;WHERE  TRUNC (DT_HR_SOLICITACAO) >= TO_DATE('09/10/2019','DD/MM/YYYY') AND  NM_DESC_PEDIDO LIKE '%|origem:%';;;SELECT *  FROM INN.EXT_ADMINSITE ;WHERE TRIM(SUBSTR(NM_DESC_PEDIDO,INSTR(NM_DESC_PEDIDO,'|origem:')+8)) IN ('NETAPP','MINHANET','MEUTECNICO','BOT','NETAPPNOVO','MIND');;;/*O Segundo exemplo é o filtro que podemos aplicar para trazer somente os canais que a Ligia gerou.;;Isso é somente para validação.;;Abraços*/;;;---=================================================================================================================;-- retirar dblink;;--- DWH.BI_FP_ASSINANTE_ATEND_FECHADO@baseclaro;;---=================================================================================================================;;----------------------------------ORGINAL (CONSOLIDADO); ;SELECT /*+ PARALLEL (32)*/;       -- A.NUM_NTC                         as USERNAME,;       -- TO_DATE(TO_CHAR(DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')||' '||HOR_INICIO_ATENDIMENTO,'RRRRMMDD HH24MISS') DT_ATENDIMENTO,;       TO_NUMBER(TO_CHAR(DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')) SK_DATA,;       COUNT(*) AS ACESSOS_CMV,;       COUNT(DISTINCT(A.NUM_NTC)) AS UNICOS_CMV;       -- RPAD(HOR_INICIO_ATENDIMENTO, 2)                        HORA,;       -- 1                                                      TT_MINHANET_CLARO;       ;       FROM DWH.BI_FP_ASSINANTE_ATEND_FECHADO A;            --   LEFT JOIN FT_CLIENTE_DIGITAL_TMP110 B;              --        ON A.DW_NUM_NTC = B.SK_NUMERO_TELEFONE;       WHERE DW_METODO_CONTATO IN (81, 411, 451,681,701,552);           AND DAT_INICIO_ATENDIMENTO BETWEEN TO_DATE(&DATA_INICIAL, 'RRRRMMDD') AND  TO_DATE(&DATA_FINAL, 'RRRRMMDD');           -- NOVO FILTRO  -- SOMENTE USUÁRIOS QUE AUTENTICARAM -- EX: MinhaClaroWebPF: Autenticação de usuário;           AND UPPER(A.DSC_OBSERVACAO_ATENDIMENTO) LIKE '%MINHACLAROWEB%AUTENTICA%USU%';       GROUP BY;           TO_NUMBER(TO_CHAR(DAT_INICIO_ATENDIMENTO, 'RRRRMMDD'));;;---------------------------------- ANALÍTICO USUÁRIOS UNICOS;;SELECT /*+ PARALLEL (32)*/;        A.NUM_NTC                         as NTC;       ,TO_DATE(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')||' '||A.HOR_INICIO_ATENDIMENTO,'RRRRMMDD HH24MISS') DT_ATENDIMENTO;       ,TO_NUMBER(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')) SK_DATA;       ,COUNT(*) AS ACESSOS_CMV;       ,COUNT(DISTINCT(A.NUM_NTC)) AS UNICOS_CMV;       ,RPAD(HOR_INICIO_ATENDIMENTO, 2)                        HORA;       ,1                                                      TT_MINHANET_CLARO;--SELECT       ;       FROM DWH.BI_FP_ASSINANTE_ATEND_FECHADO A;            --   LEFT JOIN FT_CLIENTE_DIGITAL_TMP110 B;              --        ON A.DW_NUM_NTC = B.SK_NUMERO_TELEFONE;       WHERE DW_METODO_CONTATO IN (81, 411, 451,681,701,552);           AND DAT_INICIO_ATENDIMENTO BETWEEN TO_DATE(&DATA_INICIAL, 'RRRRMMDD') AND  TO_DATE(&DATA_FINAL, 'RRRRMMDD');           -- NOVO FILTRO  -- SOMENTE USUÁRIOS QUE AUTENTICARAM -- EX: MinhaClaroWebPF: Autenticação de usuário;           AND UPPER(A.DSC_OBSERVACAO_ATENDIMENTO) LIKE '%MINHACLAROWEB%AUTENTICA%USU%';       GROUP BY;           A.NUM_NTC ;           ,TO_DATE(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')||' '||A.HOR_INICIO_ATENDIMENTO,'RRRRMMDD HH24MISS');           ,TO_NUMBER(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')) ;           ,HOR_INICIO_ATENDIMENTO;;;