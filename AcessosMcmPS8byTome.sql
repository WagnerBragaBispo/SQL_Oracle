SELECT         ;         A.*;         ,B.DSC_METODO_CONTATO                                                       ; ; FROM DWH.BI_FP_ASSINANTE_ATEND_FECHADO A;INNER JOIN BI_DIM_METODO_CONTATO B ON A.DW_METODO_CONTATO = B.DW_METODO_CONTATO;;     WHERE  A.DW_METODO_CONTATO IN (81, 411, 451,701) --EXPURGO 681 FLEX, 552 Minha Claro Empresa;     AND TO_DATE(A.DAT_INICIO_ATENDIMENTO,'DD/MM/RRRR') BETWEEN LAST_DAY(ADD_MONTHS(TO_DATE('&DT_REFERENCIA', 'DD/MM/RRRR'),-9))+1;                                                        AND  ;                                                        LAST_DAY(TO_DATE('&DT_REFERENCIA', 'DD/MM/RRRR'));      ;;      ;      -- TESTE NTC WAGNER       AND NUM_NTC = '11980299093'                                                            ;;--========================================================================================================================;--                              PEDIDO DA FRANCINE: ACESSOS DOS CLIENTES RELATIVOS AO PS8;--  BRIEFING:;-- HISTÓRICO DOS ULTIMOS 6 MESES ;-- DE 200 CLIENTES RELATIVO AOS;-- PRODUTOS PRÉ PAGO/CONTROLE/PÓS;-- DDD41                            ;-- 11980185386 NTC_FLEX TENTOU ACESSAR MINHA CLARO;--========================================================================================================================;--SELECT COUNT (DISTINCT NUM_NTC || TO_CHAR(DT_INI_ATENDIMENTO,'RRRRMMDD HH24MISS'))  AS QTD_ACESSOS -- 1.546.851;--SELECT *  FROM INN.EXT_ADMINSITE;;--SELECT *  FROM INN.EXT_ADMINSITE WHERE TRIM(SUBSTR(NM_DESC_PEDIDO,INSTR(NM_DESC_PEDIDO,'|origem:')+8)) IN ('NETAPP','MINHANET','MEUTECNICO','BOT','NETAPPNOVO','MIND');;--SELECT * FROM BI_DIM_MOTIVO_ATENDIMENTO;;---SELECT * FROM ALL_ALL_TABLES WHERE OWNER LIKE 'DWH' AND TABLE_NAME LIKE '%HIS%ASS%';;;SELECT /*PARALELL (32)*/         ;         SUBSTR(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD'),1,6) AS SAFRA;         ,A.NUM_NTC;         ,SUBSTR(A.NUM_NTC,1,2) AS DDD;         ,HIS.COD_AREA;         ,MIN(TO_DATE(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')||' '||HOR_INICIO_ATENDIMENTO,'RRRRMMDD HH24MISS')) DT_PRI_ATEND;         ,HIS.COD_PLATAFORMA_ATU;         ,regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_1,'00000')||;                                  TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_2,'00000')|| ;                                  TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_3,'00000'),'[[:space:]]*','')||;                         (CASE WHEN MA.COD_MOTIVO_ATEND_NIVEL_4 = -3 THEN '00000' ;                               ELSE (regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_4,'00000'),'[[:space:]]*',''))END)||;                          (CASE WHEN MA.COD_MOTIVO_ATEND_NIVEL_5 = -3 THEN '00000' ;                                ELSE (regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_5,'00000'),'[[:space:]]*',''))END) ;                                     AS ID_MOTIVOS_TUPLA;          ;                                                                ;;FROM DWH.BI_FP_ASSINANTE_ATEND_FECHADO A;INNER JOIN BI_DIM_METODO_CONTATO MT             ON A.DW_METODO_CONTATO = MT.DW_METODO_CONTATO;LEFT JOIN BI_DIM_MOTIVO_ATENDIMENTO MA          ON A.DW_MOTIVO_ATENDIMENTO = MA.DW_MOTIVO_ATENDIMENTO;LEFT JOIN BI_HIS_ASSINANTE HIS                  ON A.NUM_NTC = HIS.NUM_NTC ;                                                AND SUBSTR(TO_CHAR(A.DAT_INICIO_ATENDIMENTO,'RRRRMMDD'),1,6) = SUBSTR(TO_CHAR(HIS.DAT_MOVIMENTO,'RRRRMMDD'),1,6) ;;;     WHERE  A.DW_METODO_CONTATO IN (81, 411, 451,701) --EXPURGO 681 FLEX, 552 Minha Claro Empresa;     AND A.DAT_INICIO_ATENDIMENTO BETWEEN TO_DATE(&DATA_INICIAL, 'RRRRMMDD') AND  TO_DATE(&DATA_FINAL, 'RRRRMMDD')                                                  ;     AND SUBSTR(A.NUM_NTC,1,2) LIKE '41' ---- DDD QUE A FRANCINE SOLICITOU;     AND HIS.DAT_MOVIMENTO BETWEEN TO_DATE(&DATA_INICIAL, 'RRRRMMDD') AND  TO_DATE(&DATA_FINAL, 'RRRRMMDD'); ; GROUP BY SUBSTR(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD'),1,6) ;         ,A.NUM_NTC;         ,SUBSTR(A.NUM_NTC,1,2);         ,HIS.COD_AREA ;         ,TO_DATE(TO_CHAR(A.DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')||' '||HOR_INICIO_ATENDIMENTO,'RRRRMMDD HH24MISS');         ,HIS.COD_PLATAFORMA_ATU;         ,regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_1,'00000')||;                                  TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_2,'00000')|| ;                                  TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_3,'00000'),'[[:space:]]*','')||;                         (CASE WHEN MA.COD_MOTIVO_ATEND_NIVEL_4 = -3 THEN '00000' ;                               ELSE (regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_4,'00000'),'[[:space:]]*',''))END)||;                          (CASE WHEN MA.COD_MOTIVO_ATEND_NIVEL_5 = -3 THEN '00000' ;                                ELSE (regexp_replace(TO_CHAR(MA.COD_MOTIVO_ATEND_NIVEL_5,'00000'),'[[:space:]]*',''))END) ;                                     ; ;;;--========================================================================================================================;SELECT /*+ PARALLEL (32)*/;;                                         TO_NUMBER(TO_CHAR(DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')) SK_DATA,;                                         COUNT(*) AS QTD_ACSS_CMV;                                  FROM DWH.BI_FP_ASSINANTE_ATEND_FECHADO@BASECLARO A;                                         WHERE DW_METODO_CONTATO IN (81, 411, 451,681,701,552);                                               AND DAT_INICIO_ATENDIMENTO BETWEEN TO_DATE(&DATA_INICIAL, 'RRRRMMDD') AND  TO_DATE(&DATA_FINAL, 'RRRRMMDD');                                             -- NOVO FILTRO  -- SOMENTE USUÁRIOS QUE AUTENTICARAM -- EX: MinhaClaroWebPF: Autenticação de usuário;                                                AND UPPER(A.DSC_OBSERVACAO_ATENDIMENTO) LIKE '%MINHACLAROWEB%AUTENTICA%USU%';                                          GROUP BY;                                              TO_NUMBER(TO_CHAR(DAT_INICIO_ATENDIMENTO, 'RRRRMMDD')));                                                        ;